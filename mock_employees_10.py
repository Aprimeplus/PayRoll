import pandas as pd
import random
from datetime import datetime, timedelta

# ==========================================
# ฟังก์ชันช่วยสร้างข้อมูลสุ่ม
# ==========================================
def generate_id_card():
    """สร้างเลขบัตรประชาชน 13 หลักแบบสุ่ม"""
    return "".join([str(random.randint(0, 9)) for _ in range(13)])

def generate_start_date():
    """สุ่มวันที่เข้างานในช่วง 10 ปีที่ผ่านมา เพื่อเทสการ Sort"""
    start = datetime(2015, 1, 1)
    end = datetime(2024, 12, 31)
    delta = end - start
    random_days = random.randrange(delta.days)
    return (start + timedelta(days=random_days)).strftime("%Y-%m-%d")

# ==========================================
# ข้อมูลตั้งต้น (ชื่อ-นามสกุล-ที่อยู่)
# ==========================================
first_names = ["สมชาย", "สมหญิง", "วีระ", "มานี", "ปิติ", "ชูใจ", "มานะ", "สมศรี", "อำนวย", "กานดา"]
last_names = ["ใจดี", "รักเรียน", "มีสุข", "ขยันยิ่ง", "อดทน", "สะอาด", "กล้าหาญ", "สดใส", "มั่นคง", "จริงใจ"]
addresses = [
    "123/4 ถ.สุขุมวิท แขวงคลองตัน เขตคลองเตย กทม. 10110",
    "55/8 หมู่ 3 ต.บางพลีใหญ่ อ.บางพลี จ.สมุทรปราการ 10540",
    "99/9 ถ.พหลโยธิน แขวงสามเสนใน เขตพญาไท กทม. 10400",
    "456 ซ.ลาดพร้าว 101 แขวงคลองจั่น เขตบางกะปิ กทม. 10240",
    "78/1 ถ.เพชรเกษม แขวงหนองค้างพลู เขตหนองแขม กทม. 10160",
    "22/5 หมู่ 5 ต.ปากเกร็ด อ.ปากเกร็ด จ.นนทบุรี 11120",
    "88/2 ถ.วิภาวดีรังสิต แขวงจอมพล เขตจตุจักร กทม. 10900",
    "333/3 ถ.พระราม 9 แขวงห้วยขวาง เขตห้วยขวาง กทม. 10310",
    "11/1 หมู่ 2 ต.คลองหนึ่ง อ.คลองหลวง จ.ปทุมธานี 12120",
    "987 ถ.จรัญสนิทวงศ์ แขวงบางอ้อ เขตบางพลัด กทม. 10700"
]

# ==========================================
# สร้างข้อมูล 10 รายการ
# ==========================================
data = []
for i in range(10):
    row = {
        "id_card": generate_id_card(),        # เลข 13 หลัก
        "prefix": random.choice(["นาย", "นาง", "นางสาว"]),
        "fname": first_names[i],              # ชื่อ
        "lname": last_names[i],               # นามสกุล
        "address": addresses[i],              # ที่อยู่
        "start_date": generate_start_date(),  # วันที่เข้างาน (สำคัญสำหรับการเรียง)
        # แถมฟิลด์รายได้/ภาษีให้ด้วย เผื่อต้องใช้กับโค้ดเก่า
        "annual_income": random.randint(240000, 1200000), 
        "annual_tax": random.randint(0, 50000)           
    }
    data.append(row)

# ==========================================
# บันทึกลงไฟล์ CSV
# ==========================================
df = pd.DataFrame(data)
csv_filename = "mock_employees_10.csv"
df.to_csv(csv_filename, index=False, encoding='utf-8-sig')

print(f"✅ สร้างไฟล์ {csv_filename} เรียบร้อยแล้ว มีข้อมูล {len(df)} แถว")
print(df[["fname", "start_date"]].head(10)) # โชว์ตัวอย่างวันที่ให้ดู